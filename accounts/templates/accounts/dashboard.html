{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Dashboard" %} - AIMS EXAM{% endblock %}

{% block content %}
<div class="topbar">
    <h1 class="topbar-title">{% trans "Dashboard" %}</h1>
    <div class="topbar-actions">
        <span class="text-muted">
            {% now "l, d F Y" %}
        </span>
    </div>
</div>

{% include 'partials/messages.html' %}

{% if user.is_super_admin %}
<!-- Super Admin Dashboard -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10B981;">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        </div>
        <div class="stat-info">
            <div class="stat-value">{{ total_schools|default:"0" }}</div>
            <div class="stat-label">{% trans "Schools" %}</div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: #3B82F6;">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        </div>
        <div class="stat-info">
            <div class="stat-value">{{ total_teachers|default:"0" }}</div>
            <div class="stat-label">{% trans "Teachers" %}</div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: #F59E0B;">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
        </div>
        <div class="stat-info">
            <div class="stat-value">{{ total_students|default:"0" }}</div>
            <div class="stat-label">{% trans "Students" %}</div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(139, 92, 246, 0.1); color: #8B5CF6;">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
        </div>
        <div class="stat-info">
            <div class="stat-value">{{ total_admins|default:"0" }}</div>
            <div class="stat-label">{% trans "Admins" %}</div>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--spacing-xl);">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">{% trans "Quick Actions" %}</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
            <a href="{% url 'schools:list' %}" class="btn btn-outline">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                </svg>
                {% trans "Manage Schools" %}
            </a>
            <a href="{% url 'accounts:users' %}" class="btn btn-outline">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                </svg>
                {% trans "Manage Users" %}
            </a>
            <a href="{% url 'accounts:teacher_create' %}" class="btn btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                {% trans "Add New Teacher" %}
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title">{% trans "System Status" %}</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span class="text-secondary">{% trans "Database" %}</span>
                <span class="badge badge-success">{% trans "Online" %}</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span class="text-secondary">{% trans "Platform" %}</span>
                <span class="badge badge-success">{% trans "Active" %}</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span class="text-secondary">{% trans "Version" %}</span>
                <span class="text-muted">1.0.0</span>
            </div>
        </div>
    </div>
</div>

{% elif user.is_teacher %}
<!-- Teacher Dashboard -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </svg>
        </div>
        <div class="stat-info">
            <div class="stat-value">{{ school.name|default:"â€”" }}</div>
            <div class="stat-label">{% trans "Your School" %}</div>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--spacing-xl);">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">{% trans "Quick Actions" %}</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
            <a href="{% url 'zipgrade:upload' %}" class="btn btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                {% trans "Upload ZipGrade Results" %}
            </a>
            <a href="{% url 'exams:exam_create' %}" class="btn btn-outline">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                {% trans "Create New Exam" %}
            </a>
            <a href="{% url 'analytics:schools' %}" class="btn btn-outline">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="20" x2="18" y2="10"></line>
                    <line x1="12" y1="20" x2="12" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="14"></line>
                </svg>
                {% trans "View Analytics" %}
            </a>
        </div>
    </div>
</div>

{% else %}
<!-- Student Dashboard -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">{% trans "My Exams" %}</h3>
    </div>

    {% if upcoming_exams %}
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>{% trans "Exam" %}</th>
                    <th>{% trans "Subject" %}</th>
                    <th>{% trans "Date" %}</th>
                    <th>{% trans "Status" %}</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for exam in upcoming_exams %}
                <tr>
                    <td>{{ exam.title }}</td>
                    <td>{{ exam.subject.name }}</td>
                    <td>{{ exam.start_time|date:"d M Y, H:i" }}</td>
                    <td>
                        <span class="badge badge-primary">{% trans "Upcoming" %}</span>
                    </td>
                    <td>
                        <a href="#" class="btn btn-sm btn-primary">{% trans "Start" %}</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: var(--spacing-xl); color: var(--text-muted);">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="1.5" style="margin-bottom: var(--spacing-md); opacity: 0.5;">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
        <p>{% trans "No upcoming exams at the moment." %}</p>
    </div>
    {% endif %}
</div>
{% endif %}
{% endblock %}